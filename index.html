<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>SCARLETT ONE | DEV-STATION v4.0.8</title>
    <style>
        :root { --neon-green: #00ff00; --panel-bg: rgba(0, 10, 0, 0.9); }
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Courier New', monospace; color: var(--neon-green); }
        
        /* DIAGNOSTICS PANEL */
        #dev-hud {
            position: absolute; top: 10px; left: 10px; border: 1px solid var(--neon-green);
            padding: 10px; background: var(--panel-bg); z-index: 100; pointer-events: none;
            font-size: 12px; box-shadow: 0 0 15px rgba(0, 255, 0, 0.2);
        }

        /* LIVE LOG (Catching Android Errors) */
        #console-log {
            position: absolute; bottom: 80px; left: 10px; width: 300px; height: 120px;
            background: rgba(0,0,0,0.8); border: 1px solid #444; font-size: 10px;
            overflow-y: auto; padding: 5px; color: #aaa; z-index: 90;
        }

        /* ANDROID DEBUG PADS */
        #touch-controls {
            position: absolute; bottom: 20px; right: 20px; width: 120px; height: 120px;
            border: 2px dashed var(--neon-green); border-radius: 50%; z-index: 100;
            display: flex; align-items: center; justify-content: center; opacity: 0.5;
        }
        #joystick-nub { width: 40px; height: 40px; background: var(--neon-green); border-radius: 50%; }

        /* MODULE LIST (Check existence) */
        #module-check { position: absolute; top: 10px; right: 10px; text-align: right; font-size: 11px; }
        .mod-ok { color: var(--neon-green); }
        .mod-err { color: #ff0000; font-weight: bold; }

        /* LAUNCHER */
        #ui-bar { position: absolute; bottom: 20px; width: 100%; text-align: center; }
        .dev-btn { 
            padding: 15px 30px; background: #000; border: 1px solid var(--neon-green);
            color: var(--neon-green); cursor: pointer; text-transform: uppercase;
        }
        .dev-btn:hover { background: var(--neon-green); color: #000; }
    </style>
</head>
<body>

    <div id="dev-hud">
        [ SYSTEM: SCARLETT ONE SVR ]<br>
        LINK: <span id="st-val">OFFLINE</span><br>
        FPS: <span id="fps-val">--</span><br>
        POS: <span id="pos-val">0, 0, 0</span><br>
        XR_READY: <span id="xr-val">CHECKING...</span>
    </div>

    <div id="module-check">
        INDEX.JS: <span id="m-index" class="mod-err">MISSING</span><br>
        WORLD.JS: <span id="m-world" class="mod-err">MISSING</span><br>
        TEXTURES: <span id="m-tex" class="mod-err">NOT DETECTED</span>
    </div>

    <div id="console-log">Initializing Dev Stream...</div>

    <div id="touch-controls">
        <div id="joystick-nub"></div>
    </div>

    <div id="ui-bar">
        <button id="entervr" class="dev-btn">Initialize VR / Hand-Tracking</button>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        // --- CUSTOM DEV LOGGER ---
        const logPanel = document.getElementById('console-log');
        const originalLog = console.log;
        console.log = (...args) => {
            const msg = args.join(' ');
            logPanel.innerHTML += `> ${msg}<br>`;
            logPanel.scrollTop = logPanel.scrollHeight;
            originalLog(...args);
        };

        // --- MODULE SCANNER ---
        async function checkFile(path, elementId) {
            const el = document.getElementById(elementId);
            try {
                const r = await fetch(path, { method: 'HEAD' });
                if(r.ok) { el.innerText = 'OK'; el.className = 'mod-ok'; }
            } catch(e) { console.log(`File error: ${path}`); }
        }

        import { initEngine } from './js/scarlett1/index.js';

        window.addEventListener('load', () => {
            console.log("SVR Master Boot...");
            
            // Check files
            checkFile('./js/scarlett1/index.js', 'm-index');
            checkFile('./js/scarlett1/world.js', 'm-world');
            checkFile('./assets/textures/floor.jpg', 'm-tex');

            // Check XR
            if (navigator.xr) {
                navigator.xr.isSessionSupported('immersive-vr').then(ok => {
                    document.getElementById('xr-val').innerText = ok ? 'YES' : 'NO_HARDWARE';
                });
            }

            try {
                initEngine();
                document.getElementById('st-val').innerText = 'ACTIVE';
                document.getElementById('st-val').style.color = '#00ff00';
            } catch (e) {
                console.log("FATAL: " + e.message);
            }
        });
    </script>
</body>
</html>
